<!doctype html><html lang=it><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Running NATS on a FreeBSD Jail - Simone Vellei - Blog</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://simonevellei.com/running-nats-on-a-freebsd-jail/">
<meta property="og:site_name" content="Simone Vellei - Blog"><meta property="og:title" content="Running NATS on a FreeBSD Jail"><meta property="og:description" content="Last few months I played with FreeBSD and my Rock64 embedded boards [1] [2]. I really enjoyed the experience and I wanted to go to the next level and experiment with FreeBSD jails. I was surprised how easy (and logical) it was to create and manage an isolated environment. I also noticed that the low level commands have been wrapped into a more user friendly interfaces (like bastille) making the whole experience more enjoyable. To have a real example of a microservice running on a jail, I decided to try with NATS."><meta property="og:locale" content="it"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-01T15:26:03+01:00"><meta property="article:modified_time" content="2025-01-01T15:26:03+01:00"><meta property="article:tag" content="Nats"><meta property="article:tag" content="Freebsd"><meta property="article:tag" content="Jail"><meta property="article:tag" content="Bastille"><meta property="article:tag" content="Go"><meta property="og:image" content="https://simonevellei.com/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://simonevellei.com/logo.png"><meta name=twitter:title content="Running NATS on a FreeBSD Jail"><meta name=twitter:description content="Last few months I played with FreeBSD and my Rock64 embedded boards [1] [2]. I really enjoyed the experience and I wanted to go to the next level and experiment with FreeBSD jails. I was surprised how easy (and logical) it was to create and manage an isolated environment. I also noticed that the low level commands have been wrapped into a more user friendly interfaces (like bastille) making the whole experience more enjoyable. To have a real example of a microservice running on a jail, I decided to try with NATS."><meta name=application-name content="Simone Vellei"><meta name=apple-mobile-web-app-title content="Simone Vellei"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://simonevellei.com/running-nats-on-a-freebsd-jail/><link rel=prev href=https://simonevellei.com/3-anni-da-remoto-12-lezioni-imparate/><link rel=next href=https://simonevellei.com/referendum-2025/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Running NATS on a FreeBSD Jail","inLanguage":"it","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/simonevellei.com\/running-nats-on-a-freebsd-jail\/"},"genre":"posts","keywords":"nats, freebsd, jail, bastille, go","wordcount":1472,"url":"https:\/\/simonevellei.com\/running-nats-on-a-freebsd-jail\/","datePublished":"2025-01-01T15:26:03+01:00","dateModified":"2025-01-01T15:26:03+01:00","license":"Â© 2025 Simone Vellei. All rights reserved.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Simone Vellei"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Simone Vellei - Blog"><span class=header-title-pre>ðŸ‘‹</span>Simone Vellei</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Simone Vellei - Blog"><span class=header-title-pre>ðŸ‘‹</span>Simone Vellei</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Running NATS on a FreeBSD Jail</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Simone Vellei</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2025-01-01>2025-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1472 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;7 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/nats001.png data-srcset="/images/nats001.png, /images/nats001.png 1.5x, /images/nats001.png 2x" data-sizes=auto alt=/images/nats001.png title=/images/nats001.png></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#what-is-nats>What is NATS?</a></li><li><a href=#what-is-a-freebsd-jail>What is a FreeBSD jail?</a></li><li><a href=#what-is-bastille>What is Bastille?</a><ul><li><a href=#implementing-a-bastille-template-for-nats>Implementing a Bastille template for NATS</a></li></ul></li><li><a href=#creating-a-nats-jail>Creating a NATS jail</a></li><li><a href=#testing-the-nats-jail>Testing the NATS jail</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><p>Last few months I played with FreeBSD and my Rock64 embedded boards [<a href=https://simonevellei.com/blog/posts/freebsd-on-a-rock64-board/ target=_blank rel="noopener noreffer">1</a>] [<a href=https://simonevellei.com/blog/posts/netbsd-on-a-rock64-board/ target=_blank rel="noopener noreffer">2</a>]. I really enjoyed the experience and I wanted to go to the next level and experiment with FreeBSD jails. I was surprised how easy (and logical) it was to create and manage an isolated environment. I also noticed that the low level commands have been wrapped into a more user friendly interfaces (like <code>bastille</code>) making the whole experience more enjoyable. To have a real example of a microservice running on a jail, I decided to try with <a href=https://nats.io target=_blank rel="noopener noreffer">NATS</a>.</p><h2 id=what-is-nats>What is NATS?</h2><p><a href=https://nats.io target=_blank rel="noopener noreffer">NATS</a> is an open-source messaging system that is designed for cloud-native applications, IoT messaging, and microservices architectures. It provides a lightweight, high-performance, and secure communication mechanism that supports both publish-subscribe and request-reply patterns. NATS is known for its simplicity, ease of use, and ability to scale horizontally, making it an ideal choice for distributed systems.</p><p>One of the key features of NATS is its ability to handle high-throughput and low-latency messaging. It achieves this through a combination of efficient protocol design, in-memory data structures, and optimized network communication. NATS also supports clustering, which allows multiple NATS servers to work together to provide fault tolerance and load balancing.</p><p>In addition to its core messaging capabilities, NATS has a rich ecosystem of clients and libraries for various programming languages, making it easy to integrate with different applications and services. It also offers advanced features such as streaming, persistence, and security, which can be leveraged to build robust and reliable messaging solutions.</p><h2 id=what-is-a-freebsd-jail>What is a FreeBSD jail?</h2><p>FreeBSD jails are a powerful and flexible feature of the FreeBSD operating system that allow you to create isolated, secure environments within a single FreeBSD instance. Introduced in FreeBSD 4.0, jails provide a lightweight alternative to full virtualization, enabling you to run multiple applications or services in separate, confined spaces without the overhead of a full virtual machine.</p><p>A FreeBSD jail operates as a chroot environment with additional security and resource management features. Each jail has its own filesystem, network interfaces, and process space, ensuring that processes running inside a jail cannot interfere with those in other jails or the host system. This isolation makes jails an excellent choice for securely hosting multiple applications on a single server, testing software in a controlled environment, or managing multi-tenant environments.</p><p>Jails are highly configurable, allowing you to fine-tune the level of isolation and resource allocation for each jail. You can assign specific IP addresses, limit CPU and memory usage, and control access to system resources. This flexibility, combined with the lightweight nature of jails, makes them a popular choice for both development and production environments.</p><h2 id=what-is-bastille>What is Bastille?</h2><p><a href=https://bastillebsd.org/ target=_blank rel="noopener noreffer">Bastille</a> is a command-line utility for managing FreeBSD jails. It simplifies the process of creating, configuring, and maintaining jails, which are lightweight, isolated environments similar to containers. Bastille provides an easy-to-use interface for jail management, allowing users to quickly deploy and manage applications in a secure and efficient manner.</p><p>With Bastille, you can create new jails, start and stop them, and manage their configurations with simple commands. It also supports templates, which can be used to automate the deployment of pre-configured environments. This makes it an excellent tool for both development and production use cases, where consistency and repeatability are important.</p><p>Bastille also integrates with ZFS, a robust file system that provides advanced features such as snapshots and cloning. This integration allows for efficient storage management and easy rollback of changes, further enhancing the flexibility and reliability of your jail environments.</p><h3 id=implementing-a-bastille-template-for-nats>Implementing a Bastille template for NATS</h3><p>Bastille templates are pre-configured environments that can be used to quickly deploy new jails. They contain a base FreeBSD installation along with any additional packages or configurations that you want to include. Templates are a powerful feature of Bastille that can help you streamline your workflow and ensure consistency across your environments.</p><p>The idea is to be architecture agnostic, so the template can be used in any FreeBSD system. NATS will be compiled from source, so the template will contain the necessary packages to build it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># install required packages</span>
</span></span><span class=line><span class=cl>PKG git
</span></span><span class=line><span class=cl>PKG go
</span></span></code></pre></td></tr></table></div></div><p>Then we can create specific user and group for NATS:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># create default group</span>
</span></span><span class=line><span class=cl>CMD pw groupadd <span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_GROUP</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># create default user</span>
</span></span><span class=line><span class=cl>CMD pw useradd -n <span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_USER</span><span class=si>}</span><span class=s2>&#34;</span> -g <span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_GROUP</span><span class=si>}</span><span class=s2>&#34;</span> -s /usr/sbin/nologin -w no
</span></span></code></pre></td></tr></table></div></div><p>We&rsquo;ll accept group and user names as environment variables, so we can customize them when creating the jail from the template.</p><p>Now it&rsquo;s time to clone the NATS repository and compile it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># download and install nats server</span>
</span></span><span class=line><span class=cl>CMD <span class=s2>&#34;</span><span class=si>${</span><span class=nv>GO</span><span class=si>}</span><span class=s2>&#34;</span> install <span class=s2>&#34;github.com/nats-io/nats-server/v2@</span><span class=si>${</span><span class=nv>NATS_VERSION</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>CMD <span class=s2>&#34;</span><span class=si>${</span><span class=nv>INSTALL</span><span class=si>}</span><span class=s2>&#34;</span> -o <span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_USER</span><span class=si>}</span><span class=s2>&#34;</span> -g <span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_GROUP</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>GOPATH</span><span class=si>}</span><span class=s2>/bin/nats-server&#34;</span> /usr/local/bin/nats-server
</span></span></code></pre></td></tr></table></div></div><p>We&rsquo;ll use <code>go install</code> to download and compile the NATS server, and then we&rsquo;ll install it in the <code>/usr/local/bin</code> directory. We&rsquo;ll also set the owner and group of the binary to the user and group we created earlier.</p><p>As soon as we have the NATS server installed, we can create a configuration file and an init script for it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>CP usr /
</span></span><span class=line><span class=cl>CMD chmod a+x /usr/local/etc/rc.d/nats
</span></span></code></pre></td></tr></table></div></div><p>The <code>usr</code> directory contains the configuration file and the init script for the NATS server. We&rsquo;ll copy them to the root directory of the jail and make the init script executable.</p><p>Finally, we&rsquo;ll set the NATS server to start automatically when the jail boots:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>SYSRC <span class=nv>nats_enable</span><span class=o>=</span>YES
</span></span><span class=line><span class=cl>SYSRC <span class=nv>nats_user</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_USER</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>SYSRC <span class=nv>nats_group</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>NATS_GROUP</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>SERVICE nats start
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Don&rsquo;t worry too much about the template; you&rsquo;ll find a link to the repository with the complete code at the end of the article.</p></blockquote><h2 id=creating-a-nats-jail>Creating a NATS jail</h2><p>In order to let Bastille create a jail from a template we need to bootstrap it first:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille bootstrap https://github.com/henomis/nats-jail-template
</span></span></code></pre></td></tr></table></div></div><p>This command will download the template from the repository, you&rsquo;ll find it into the directory <code>/usr/local/bastille/templates/</code></p><p>Now we can create the jail:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille create nats-jail 14.2-RELEASE 10.0.0.1
</span></span></code></pre></td></tr></table></div></div><p>This command will create a new jail named <code>nats-jail</code>. The jail will be based on FreeBSD 14.2-RELEASE and will have the IP address <code>10.0.0.1</code>. It&rsquo;s time to apply the template:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille template nats-jail henomis/nats-jail-template
</span></span></code></pre></td></tr></table></div></div><p>This command will apply the template to the jail, installing all the necessary packages and configurations. Once the template is applied, you&rsquo;ll have a fully functional NATS server running in the jail.</p><h2 id=testing-the-nats-jail>Testing the NATS jail</h2><p>To test the NATS jail, you can connect to it using the NATS CLI tool. But, as we already had fun with jails, we can create a new jails and run the NATS CLI tool in it. We will set up a publisher and a subscriber in two different jails, and we&rsquo;ll use the NATS server to send messages between them.</p><p>Let&rsquo;s create a new jail for the publisher:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille create pub-jail 14.2-RELEASE 10.0.0.2
</span></span></code></pre></td></tr></table></div></div><p>Then we&rsquo;ll install the necessary packages and the NATS CLI tool:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille pkg pub-jail install -y git go
</span></span><span class=line><span class=cl>bastille cmd pub-jail go install github.com/nats-io/natscli/nats@latest
</span></span></code></pre></td></tr></table></div></div><p>Thanks to <code>bastille clone</code> we can create a new jail from an existing one, so we can clone the publisher jail and create a subscriber jail:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille clone pub-jail sub-jail 10.0.0.3
</span></span><span class=line><span class=cl>bastille start sub-jail
</span></span></code></pre></td></tr></table></div></div><p>We are very close to the end, we just need to start the subscriber and the publisher in two different jails:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille cmd sub-jail /root/go/bin/nats --server 10.0.0.1 sub my.topic
</span></span></code></pre></td></tr></table></div></div><p>Using a different terminal:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bastille cmd pub-jail /root/go/bin/nats --server 10.0.0.1 pub my.topic <span class=s2>&#34;message {{.Count}} - {{.TimeStamp}}&#34;</span> --count <span class=m>5</span>
</span></span></code></pre></td></tr></table></div></div><p>You should see the messages sent by the publisher in the subscriber terminal.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span><span class=c1>#1] Received on &#34;my.topic&#34;</span>
</span></span><span class=line><span class=cl>message <span class=m>1</span> - 2025-01-01T16:20:16+01:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=c1>#2] Received on &#34;my.topic&#34;</span>
</span></span><span class=line><span class=cl>message <span class=m>2</span> - 2025-01-01T16:20:16+01:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=c1>#3] Received on &#34;my.topic&#34;</span>
</span></span><span class=line><span class=cl>message <span class=m>3</span> - 2025-01-01T16:20:16+01:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=c1>#4] Received on &#34;my.topic&#34;</span>
</span></span><span class=line><span class=cl>message <span class=m>4</span> - 2025-01-01T16:20:16+01:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span><span class=c1>#5] Received on &#34;my.topic&#34;</span>
</span></span><span class=line><span class=cl>message <span class=m>5</span> - 2025-01-01T16:20:16+01:00
</span></span></code></pre></td></tr></table></div></div><p>And&mldr; that&rsquo;s it! You have a NATS server running in a FreeBSD jail, and you are able to send messages between different jails using the NATS CLI tool. You can experiment with different configurations, add more jails, and explore the capabilities of NATS and FreeBSD jails further.</p><h2 id=conclusion>Conclusion</h2><p>In this article, we have seen how to create a FreeBSD jail with Bastille and run a NATS server inside it. We have also seen how to create two additional jails and use the NATS CLI tool to send messages between them. This example demonstrates the power and flexibility of FreeBSD jails and how they can be used to create isolated, secure environments for running applications and services.</p><p>You will find the complete code in the <a href=https://github.com/henomis/nats-jail-template target=_blank rel="noopener noreffer">https://github.com/henomis/nats-jail-template</a> repository. Feel free to fork it and experiment with it on your own FreeBSD system. I hope this article has inspired you to explore the world of FreeBSD jails and experiment with different applications and services. Happy hacking!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-01-01</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/running-nats-on-a-freebsd-jail/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://simonevellei.com/running-nats-on-a-freebsd-jail/ data-hashtag=nats><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://simonevellei.com/running-nats-on-a-freebsd-jail/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://simonevellei.com/running-nats-on-a-freebsd-jail/ data-title="Running NATS on a FreeBSD Jail" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/nats/>Nats</a>,&nbsp;<a href=/tags/freebsd/>Freebsd</a>,&nbsp;<a href=/tags/jail/>Jail</a>,&nbsp;<a href=/tags/bastille/>Bastille</a>,&nbsp;<a href=/tags/go/>Go</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/3-anni-da-remoto-12-lezioni-imparate/ class=prev rel=prev title="3 anni da remoto, 12 lezioni imparate"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>3 anni da remoto, 12 lezioni imparate</a>
<a href=/referendum-2025/ class=next rel=next title="Referendum 2025, la parola ai dati">Referendum 2025, la parola ai dati<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Simone Vellei</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>