<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>FreeBSD on a ROCK64 Board | Simone Vellei Blog</title><meta name=keywords content="freebsd,linux,iot,embedded,experiment"><meta name=description content="This is a story about an embedded board and a BSD system. The title could have been &ldquo;How to resurrect a forgotten board and fall in love with BSD operating systems, again&rdquo;. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port."><meta name=author content="Simone Vellei"><link rel=canonical href=https://simonevellei.com/blog/posts/freebsd-on-a-rock64-board/><script>location.protocol!=="https:"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.replace(`https:${location.href.substring(location.protocol.length)}`))</script><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=preload href=/blog/apple-touch-icon.png as=image><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://simonevellei.com/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://simonevellei.com/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://simonevellei.com/blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://simonevellei.com/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://simonevellei.com/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="FreeBSD on a ROCK64 Board"><meta property="og:description" content="This is a story about an embedded board and a BSD system. The title could have been &ldquo;How to resurrect a forgotten board and fall in love with BSD operating systems, again&rdquo;. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port."><meta property="og:type" content="article"><meta property="og:url" content="https://simonevellei.com/blog/posts/freebsd-on-a-rock64-board/"><meta property="og:image" content="https://simonevellei.com/blog/images/rock64-004.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-01T16:37:37+01:00"><meta property="article:modified_time" content="2024-11-01T16:37:37+01:00"><meta property="og:site_name" content="Simone Vellei Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://simonevellei.com/blog/images/rock64-004.png"><meta name=twitter:title content="FreeBSD on a ROCK64 Board"><meta name=twitter:description content="This is a story about an embedded board and a BSD system. The title could have been &ldquo;How to resurrect a forgotten board and fall in love with BSD operating systems, again&rdquo;. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://simonevellei.com/blog/posts/"},{"@type":"ListItem","position":3,"name":"FreeBSD on a ROCK64 Board","item":"https://simonevellei.com/blog/posts/freebsd-on-a-rock64-board/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"FreeBSD on a ROCK64 Board","name":"FreeBSD on a ROCK64 Board","description":"This is a story about an embedded board and a BSD system. The title could have been \u0026ldquo;How to resurrect a forgotten board and fall in love with BSD operating systems, again\u0026rdquo;. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port.","keywords":["freebsd","linux","iot","embedded","experiment"],"articleBody":"This is a story about an embedded board and a BSD system. The title could have been “How to resurrect a forgotten board and fall in love with BSD operating systems, again”. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port.\nThe project was to build a cluster of 4 boards to experiment with Kubernetes and Docker. I was very excited about the project, but unfortunately, I never had the time to go through it. The only thing I did was to build a rack to hold the 4 boards together, including a small 5-port switch and a power supply. The rack was placed in a corner of my office and forgotten after some preliminary tests.\nThe resurrection Some days ago I was cleaning my office and I found the rack with the 4 boards. I decided to give it a try and see if I could make them work. I connected the power supply and the switch, and I powered on the boards. The boards were booting, I tried to connect to them using the serial console, but I couldn’t remember the root password. I took that as a sign, let’s start from scratch, again. I still had the original eMMC USB adapter to flash an OS image and more or less 20 years of IoT experience on my shoulders. Ready, set, go!\nDocumentation First thing first, let’s check the documentation. I went to the Pine64 website and I found the Rock64 device page and the Rock64 wiki. Time flies, and I remember a different website, but I’m happy to see the Release page with the latest supported OS images. There are many Linux distributions, Debian, the derived Armbian, and a plethora of Android versions. Hey, am I getting so old? Then my heart calmed down when I saw the FreeBSD, NetBSD, and OpenBSD support.\n“They are still there”, I thought.\nHowever, just to understand if the boards were still working, I decided to flash the latest Armbian image. I downloaded the image, flashed it on the eMMC, and powered on a board. The board booted, and I managed to connect to it using the serial console.\nCool! But wait…look at the ps aux output!\nSorry guys, I’m old school, I can’t stand systemd. Yes, I must confess to have been lazy last years and to have been using Ubuntu for my desktop PC, but come on, it’s an embedded board, I would have liked to squeeze the maximum performance out of it and full control of the system. My heart turned suddenly less happy.\nThe BSD way I’ll make it short, but it could deserve an additional post. My first experience with a BSD OS was with OpenBSD at the University in 2003 to pass the Security and Cryptography exam. I had to research and write a paper about the security and cryptography features of OpenBSD. I started installing OpenBSD on my desktop PC to put my hands on it, and I fell in love with it. But, again, that’s another story.\nI decided to install FreeBSD on the Rock64 boards. I went to the FreeBSD website and discovered that there were pre-built ROCK64 arm images.\n“Wow, that’s amazing!”, I thought.\nI downloaded the image, flashed it on the eMMC, and powered on a board. All seemed to work fine, but at some point the board froze. I tried to understand what was happening, but I couldn’t find the root cause. From this point on, I started to investigate the issue, and I found that the issue was related to eMMC boot support.\nAh-ah it would have been too easy!\nNever give up The issue was that the FreeBSD kernel included into the ROCK64 image didn’t support the eMMC boot. However, after some research, I found a blog post that explained how to build a custom kernel and fix the issue for that board.\nNice! But…did I tell you that I became a lazy Linux Ubuntu user?\nThe post’s author explains how to build the kernel on a FreeBSD system, and my next question was: “Is it possible to build a FreeBSD kernel on a Linux system?”. Back to Google search and this time I landed on a FreeBSD wiki page that explains how to build a FreeBSD kernel on a Linux system. I’m used to build Linux embedded systems from scratch starting from cross-compiling the kernel, so I felt at home.\nAttempt #1: Building the FreeBSD kernel on a Linux system I followed the instructions and downloaded the FreeBSD source code.\n$ git clone https://git.FreeBSD.org/src.git I then installed the required packages on my Ubuntu system\n$ sudo apt install clang libarchive-dev libbz2-dev Since Linux doesn’t include a version of bmake by default, building should be done using the script tools/build/make.py which will bootstrap bmake before attempting to build.\n$ export MAKEOBJDIRPREFIX=~/freebsd $ tools/build/make.py buildkernel TARGET=arm64 TARGET_ARCH=aarch64 KERNCONF=ROCK64 However, the build failed with an error related to the missing config command. I’m still not sure I haven’t missed something, but I decided to try another approach.\nAttempt #2: Building the FreeBSD kernel on a FreeBSD system I realized I needed a FreeBSD system to compile the kernel.\nWhat’s the fastest way to have a FreeBSD system up and running? A virtual machine somewhere in the cloud, or…a virtual machine on my PC! Where are you, QEMU, my old friend?\nThe next surprise would have been finding precompiled FreeBSD qcow2 images in the official repository. It seemed that I was lucky, and I downloaded the image and started a virtual machine with QEMU. However to have enough space to build the kernel I had to resize the disk image. From this point on, this story will become more nerdy.\nBooting the FreeBSD virtual machine Let’s resize the disk image and boot the virtual machine.\n$ qemu-img resize ~/FreeBSD-14.1-RELEASE-amd64-zfs.qcow2 +10G $ qemu-system-x86_64 -hda ~/FreeBSD-14.1-RELEASE-amd64-zfs.qcow2 -m 2048 -enable-kvm -netdev user,id=mynet0,hostfwd=tcp:127.0.0.1:7722-:22 -device e1000,netdev=mynet0 I connected to the virtual machine and then expanded the last partition on the virtual disk to make use of this new space.\n$ gpart show ada0 $ gpart resize -i 4 -a 4k ada0 Once the partition has been resized, I instructed ZFS to expand the pool to use the additional space.\n$ zpool list $ zpool online -e zroot ada0p4 Building the FreeBSD kernel After cloning the FreeBSD source code, I installed the required packages.\n$ pkg update $ pkg install git gcc gmake python pkgconf pixman bison glib and finally I built the kernel.\nmake buildkernel TARGET=arm64 KERNCONF=ROCK64 Cool! It worked! I was very close to the final goal. I only needed to copy the kernel to the ROCK64 image and then flash it on the eMMC.\nCopying the kernel to the ROCK64 image I downloaded the ROCK64 image from the FreeBSD website and uncompressed it.\n$ wget https://download.freebsd.org/ftp/snapshots/ISO-IMAGES/14.1/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img.xz $ unxz FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img.xz Then I mounted the boot partition of the image\n$ mdconfig -a -t vnode -f /root/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img $ mdconfig -l $ gpart show md0 $ mount -t ufs /dev/md0p2 /mnt Ok, back to the kernel build directory, I copied the kernel to the boot partition of the ROCK64 image and unmounted it.\n$ make installkernel TARGET=arm64 KERNCONF=ROCK64 DESTDIR=/mnt $ umount /mnt $ mdconfig -d -u md0 Flashing the eMMC I connected the eMMC USB adapter to my PC and I flashed the ROCK64 image on the eMMC.\n$ scp -P 7722 root@localhost:/root/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img ~/ $ sudo dd if=FreeBSD-13.4-STABLE-arm64-aarch64-ROCK64-20241024-9db8fd4c2adc-258557.img of=/dev/sda bs=1M status=progress The moment of truth I powered on the board, and it booted successfully. I connected to the board using the serial console and could see the FreeBSD boot messages. I was very happy, and I felt like a child with a new toy. I started to explore the system, and I found that the board was working fine. I could connect to the board using SSH, and I could install packages using the package manager.\n“I did it!”, I thought.\nConclusion and questions I’m very happy to have resurrected the Rock64 boards and to have installed FreeBSD on them. However, I have some questions that I would like to share with you.\nNice story, but was it worth it? I mean, was it worth spending so much time to install FreeBSD on a Rock64 board when I could have used QEMU to run a FreeBSD virtual machine on my PC? Yes, it was worth it. I learned a lot of things, and I had fun. The feeling of having a physical board running FreeBSD is priceless.\nNice try, could there be other, simpler ways to achieve the same result? I’m pretty sure there are different ways to achieve the same result as well as I’m also sure that I might have missed something in the process. But, again, I had fun.\nWhat was the first shell command I typed into the FreeBSD system? Did I tell you I can’t stand systemd? I wanted to be sure to have the init system I like, so I typed ls /etc/rc.d/.\nWhy did I choose FreeBSD instead of OpenBSD or NetBSD? Oh, well…this story could have a sequel 😉.\n","wordCount":"1549","inLanguage":"en","image":"https://simonevellei.com/blog/images/rock64-004.png","datePublished":"2024-11-01T16:37:37+01:00","dateModified":"2024-11-01T16:37:37+01:00","author":{"@type":"Person","name":"Simone Vellei"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://simonevellei.com/blog/posts/freebsd-on-a-rock64-board/"},"publisher":{"@type":"Organization","name":"Simone Vellei Blog","logo":{"@type":"ImageObject","url":"https://simonevellei.com/blog/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://simonevellei.com/blog accesskey=h title="Home (Alt + H)"><img src=https://simonevellei.com/blog/apple-touch-icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://linkedin.com/in/simonevellei><img src=/blog/icons/linkedin.png width=32 height=32 style=margin-top:15px></a></li><li><a href=https://www.instagram.com/simone.vellei.agile><img src=/blog/icons/instagram.png width=32 height=32 style=margin-top:15px></a></li><li><a href="https://www.facebook.com/profile.php?id=100086812039299"><img src=/blog/icons/facebook.png width=32 height=32 style=margin-top:15px></a></li><li><a href=https://www.youtube.com/channel/UCbpAhDsXEEnQlRj6skJR5Nw><img src=/blog/icons/youtube.png width=32 height=32 style=margin-top:15px></a></li><li><a href=https://simonevellei.com/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://simonevellei.com title="Simone Vellei"><span>Simone Vellei</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://simonevellei.com/blog>Home</a>&nbsp;»&nbsp;<a href=https://simonevellei.com/blog/posts/>Posts</a></div><h1 class=post-title>FreeBSD on a ROCK64 Board</h1><div class=post-meta><span title='2024-11-01 16:37:37 +0100 +0100'>November 1, 2024</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Simone Vellei</div></header><figure class=entry-cover><img loading=lazy src=https://simonevellei.com/blog/images/rock64-004.png alt><p></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#the-resurrection aria-label="The resurrection">The resurrection</a></li><li><a href=#documentation aria-label=Documentation>Documentation</a></li><li><a href=#the-bsd-way aria-label="The BSD way">The BSD way</a></li><li><a href=#never-give-up aria-label="Never give up">Never give up</a></li><li><a href=#attempt-1-building-the-freebsd-kernel-on-a-linux-system aria-label="Attempt #1: Building the FreeBSD kernel on a Linux system">Attempt #1: Building the FreeBSD kernel on a Linux system</a></li><li><a href=#attempt-2-building-the-freebsd-kernel-on-a-freebsd-system aria-label="Attempt #2: Building the FreeBSD kernel on a FreeBSD system">Attempt #2: Building the FreeBSD kernel on a FreeBSD system</a><ul><li><a href=#booting-the-freebsd-virtual-machine aria-label="Booting the FreeBSD virtual machine">Booting the FreeBSD virtual machine</a></li><li><a href=#building-the-freebsd-kernel aria-label="Building the FreeBSD kernel">Building the FreeBSD kernel</a></li><li><a href=#copying-the-kernel-to-the-rock64-image aria-label="Copying the kernel to the ROCK64 image">Copying the kernel to the ROCK64 image</a></li><li><a href=#flashing-the-emmc aria-label="Flashing the eMMC">Flashing the eMMC</a></li></ul></li><li><a href=#the-moment-of-truth aria-label="The moment of truth">The moment of truth</a></li><li><a href=#conclusion-and-questions aria-label="Conclusion and questions">Conclusion and questions</a></li></ul></div></details></div><div class=post-content><p>This is a story about an embedded board and a BSD system. The title could have been &ldquo;How to resurrect a forgotten board and fall in love with BSD operating systems, again&rdquo;.
It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port.</p><p><img loading=lazy src=/blog/images/rock64-001.png alt=image></p><p>The project was to build a cluster of 4 boards to experiment with Kubernetes and Docker. I was very excited about the project, but unfortunately, I never had the time to go through it. The only thing I did was to build a rack to hold the 4 boards together, including a small 5-port switch and a power supply. The rack was placed in a corner of my office and forgotten after some preliminary tests.</p><p><img loading=lazy src=/blog/images/rock64-003.png alt=image></p><h2 id=the-resurrection>The resurrection<a hidden class=anchor aria-hidden=true href=#the-resurrection>#</a></h2><p>Some days ago I was cleaning my office and I found the rack with the 4 boards. I decided to give it a try and see if I could make them work. I connected the power supply and the switch, and I powered on the boards. The boards were booting, I tried to connect to them using the serial console, but I couldn&rsquo;t remember the root password. I took that as a <strong>sign</strong>, let&rsquo;s start from scratch, again. I still had the original eMMC USB adapter to flash an OS image and more or less 20 years of IoT experience on my shoulders. Ready, set, go!</p><p><img loading=lazy src=/blog/images/rock64-002.png alt=image></p><h2 id=documentation>Documentation<a hidden class=anchor aria-hidden=true href=#documentation>#</a></h2><p>First thing first, let&rsquo;s check the documentation. I went to the Pine64 website and I found the <a href=https://pine64.org/devices/rock64/>Rock64 device</a> page and the <a href=https://wiki.pine64.org/wiki/Rock64>Rock64 wiki</a>. Time flies, and I remember a different website, but I&rsquo;m happy to see the <a href=https://pine64.org/documentation/ROCK64/Software/Releases/>Release</a> page with the latest supported OS images. There are many Linux distributions, Debian, the derived Armbian, and a plethora of Android versions. Hey, am I getting so old? Then my heart calmed down when I saw the FreeBSD, NetBSD, and OpenBSD support.</p><blockquote><p>&ldquo;They are still there&rdquo;, I thought.</p></blockquote><p>However, just to understand if the boards were still working, I decided to flash the latest Armbian image. I downloaded the image, flashed it on the eMMC, and powered on a board. The board booted, and I managed to connect to it using the serial console.</p><blockquote><p>Cool! But wait&mldr;look at the <code>ps aux</code> output!</p></blockquote><p>Sorry guys, I&rsquo;m old school, I can&rsquo;t stand <code>systemd</code>. Yes, I must confess to have been lazy last years and to have been using Ubuntu for my desktop PC, but come on, it&rsquo;s an embedded board, I would have liked to squeeze the maximum performance out of it and full control of the system. My heart turned suddenly less happy.</p><h2 id=the-bsd-way>The BSD way<a hidden class=anchor aria-hidden=true href=#the-bsd-way>#</a></h2><p>I&rsquo;ll make it short, but it could deserve an additional post. My first experience with a BSD OS was with OpenBSD at the University in 2003 to pass the Security and Cryptography exam. I had to research and write a paper about the security and cryptography features of OpenBSD. I started installing OpenBSD on my desktop PC to put my hands on it, and I fell in love with it. But, again, that&rsquo;s another story.</p><p>I decided to install FreeBSD on the Rock64 boards. I went to the FreeBSD website and discovered that there were pre-built ROCK64 arm images.</p><blockquote><p>&ldquo;Wow, that&rsquo;s amazing!&rdquo;, I thought.</p></blockquote><p>I downloaded the image, flashed it on the eMMC, and powered on a board. All seemed to work fine, but at some point the board froze. I tried to understand what was happening, but I couldn&rsquo;t find the root cause. From this point on, I started to investigate the issue, and I found that the issue was related to eMMC boot support.</p><blockquote><p>Ah-ah it would have been too easy!</p></blockquote><h2 id=never-give-up>Never give up<a hidden class=anchor aria-hidden=true href=#never-give-up>#</a></h2><p>The issue was that the FreeBSD kernel included into the ROCK64 image didn&rsquo;t support the eMMC boot. However, after some research, I found a <a href=https://www.idatum.net/ads-b-on-a-rock64-with-freebsd-stable14.html>blog post</a> that explained how to build a custom kernel and fix the issue for that board.</p><blockquote><p>Nice! But&mldr;did I tell you that I became a lazy Linux Ubuntu user?</p></blockquote><p>The post&rsquo;s author explains how to build the kernel on a FreeBSD system, and my next question was: &ldquo;Is it possible to build a FreeBSD kernel on a Linux system?&rdquo;. Back to Google search and this time I landed on a FreeBSD <a href=https://wiki.freebsd.org/BuildingOnNonFreeBSD>wiki page</a> that explains how to build a FreeBSD kernel on a Linux system. I&rsquo;m used to build Linux embedded systems from scratch starting from cross-compiling the kernel, so I felt at home.</p><h2 id=attempt-1-building-the-freebsd-kernel-on-a-linux-system>Attempt #1: Building the FreeBSD kernel on a Linux system<a hidden class=anchor aria-hidden=true href=#attempt-1-building-the-freebsd-kernel-on-a-linux-system>#</a></h2><p>I followed the instructions and downloaded the FreeBSD source code.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone https://git.FreeBSD.org/src.git
</span></span></code></pre></div><p>I then installed the required packages on my Ubuntu system</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install clang libarchive-dev libbz2-dev
</span></span></code></pre></div><p>Since Linux doesn&rsquo;t include a version of bmake by default, building should be done using the script <code>tools/build/make.py</code> which will bootstrap bmake before attempting to build.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ export MAKEOBJDIRPREFIX<span style=color:#f92672>=</span>~/freebsd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ tools/build/make.py buildkernel TARGET<span style=color:#f92672>=</span>arm64 TARGET_ARCH<span style=color:#f92672>=</span>aarch64 KERNCONF<span style=color:#f92672>=</span>ROCK64
</span></span></code></pre></div><p>However, the build failed with an error related to the missing <code>config</code> command. I&rsquo;m still not sure I haven&rsquo;t missed something, but I decided to try another approach.</p><h2 id=attempt-2-building-the-freebsd-kernel-on-a-freebsd-system>Attempt #2: Building the FreeBSD kernel on a FreeBSD system<a hidden class=anchor aria-hidden=true href=#attempt-2-building-the-freebsd-kernel-on-a-freebsd-system>#</a></h2><p>I realized I needed a FreeBSD system to compile the kernel.</p><blockquote><p><em>What&rsquo;s the fastest way to have a FreeBSD system up and running? A virtual machine somewhere in the cloud, or&mldr;a virtual machine on my PC! Where are you, QEMU, my old friend?</em></p></blockquote><p>The next surprise would have been finding precompiled FreeBSD qcow2 images in the <a href=https://download.freebsd.org/releases/VM-IMAGES/14.1-RELEASE/amd64/Latest/>official repository</a>. It seemed that I was lucky, and I downloaded the image and started a virtual machine with QEMU. However to have enough space to build the kernel I had to resize the disk image. From this point on, this story will become more nerdy.</p><h3 id=booting-the-freebsd-virtual-machine>Booting the FreeBSD virtual machine<a hidden class=anchor aria-hidden=true href=#booting-the-freebsd-virtual-machine>#</a></h3><p>Let&rsquo;s resize the disk image and boot the virtual machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ qemu-img resize ~/FreeBSD-14.1-RELEASE-amd64-zfs.qcow2 +10G
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ qemu-system-x86_64 -hda ~/FreeBSD-14.1-RELEASE-amd64-zfs.qcow2 -m <span style=color:#ae81ff>2048</span> -enable-kvm  -netdev user,id<span style=color:#f92672>=</span>mynet0,hostfwd<span style=color:#f92672>=</span>tcp:127.0.0.1:7722-:22 -device e1000,netdev<span style=color:#f92672>=</span>mynet0
</span></span></code></pre></div><p>I connected to the virtual machine and then expanded the last partition on the virtual disk to make use of this new space.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpart show ada0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ gpart resize -i <span style=color:#ae81ff>4</span> -a 4k ada0
</span></span></code></pre></div><p>Once the partition has been resized, I instructed ZFS to expand the pool to use the additional space.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ zpool list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ zpool online -e zroot ada0p4
</span></span></code></pre></div><h3 id=building-the-freebsd-kernel>Building the FreeBSD kernel<a hidden class=anchor aria-hidden=true href=#building-the-freebsd-kernel>#</a></h3><p>After cloning the FreeBSD source code, I installed the required packages.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pkg update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ pkg install git gcc gmake python pkgconf pixman bison glib 
</span></span></code></pre></div><p>and finally I built the kernel.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make buildkernel TARGET<span style=color:#f92672>=</span>arm64 KERNCONF<span style=color:#f92672>=</span>ROCK64
</span></span></code></pre></div><p>Cool! It worked! I was very close to the final goal. I only needed to copy the kernel to the ROCK64 image and then flash it on the eMMC.</p><h3 id=copying-the-kernel-to-the-rock64-image>Copying the kernel to the ROCK64 image<a hidden class=anchor aria-hidden=true href=#copying-the-kernel-to-the-rock64-image>#</a></h3><p>I downloaded the ROCK64 image from the <a href=https://download.freebsd.org/ftp/snapshots/ISO-IMAGES/14.1/>FreeBSD website</a> and uncompressed it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wget https://download.freebsd.org/ftp/snapshots/ISO-IMAGES/14.1/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img.xz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ unxz FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img.xz
</span></span></code></pre></div><p>Then I mounted the boot partition of the image</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mdconfig -a -t vnode -f /root/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ mdconfig -l
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ gpart show md0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ mount -t ufs /dev/md0p2 /mnt
</span></span></code></pre></div><p>Ok, back to the kernel build directory, I copied the kernel to the boot partition of the ROCK64 image and unmounted it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ make installkernel TARGET<span style=color:#f92672>=</span>arm64 KERNCONF<span style=color:#f92672>=</span>ROCK64 DESTDIR<span style=color:#f92672>=</span>/mnt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ umount /mnt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ mdconfig -d -u md0
</span></span></code></pre></div><h3 id=flashing-the-emmc>Flashing the eMMC<a hidden class=anchor aria-hidden=true href=#flashing-the-emmc>#</a></h3><p>I connected the eMMC USB adapter to my PC and I flashed the ROCK64 image on the eMMC.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ scp -P <span style=color:#ae81ff>7722</span> root@localhost:/root/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img ~/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ sudo dd <span style=color:#66d9ef>if</span><span style=color:#f92672>=</span>FreeBSD-13.4-STABLE-arm64-aarch64-ROCK64-20241024-9db8fd4c2adc-258557.img of<span style=color:#f92672>=</span>/dev/sda bs<span style=color:#f92672>=</span>1M status<span style=color:#f92672>=</span>progress
</span></span></code></pre></div><h2 id=the-moment-of-truth>The moment of truth<a hidden class=anchor aria-hidden=true href=#the-moment-of-truth>#</a></h2><p>I powered on the board, and it booted successfully. I connected to the board using the serial console and could see the FreeBSD boot messages. I was very happy, and I felt like a child with a new toy. I started to explore the system, and I found that the board was working fine. I could connect to the board using SSH, and I could install packages using the package manager.</p><blockquote><p>&ldquo;I did it!&rdquo;, I thought.</p></blockquote><p><img loading=lazy src=/blog/images/rock64-005.png alt=image></p><h2 id=conclusion-and-questions>Conclusion and questions<a hidden class=anchor aria-hidden=true href=#conclusion-and-questions>#</a></h2><p>I&rsquo;m very happy to have resurrected the Rock64 boards and to have installed FreeBSD on them. However, I have some questions that I would like to share with you.</p><ol><li><p>Nice story, but was it worth it? I mean, was it worth spending so much time to install FreeBSD on a Rock64 board when I could have used QEMU to run a FreeBSD virtual machine on my PC? <strong>Yes, it was worth it. I learned a lot of things, and I had fun. The feeling of having a physical board running FreeBSD is priceless.</strong></p></li><li><p>Nice try, could there be other, simpler ways to achieve the same result? <strong>I&rsquo;m pretty sure there are different ways to achieve the same result as well as I&rsquo;m also sure that I might have missed something in the process. But, again, I had fun.</strong></p></li><li><p>What was the first shell command I typed into the FreeBSD system? <strong>Did I tell you I can&rsquo;t stand <code>systemd</code>? I wanted to be sure to have the init system I like, so I typed <code>ls /etc/rc.d/</code>.</strong></p></li><li><p>Why did I choose FreeBSD instead of OpenBSD or NetBSD? <strong>Oh, well&mldr;this story could have a sequel 😉.</strong></p></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://simonevellei.com/blog/tags/freebsd/>freebsd</a></li><li><a href=https://simonevellei.com/blog/tags/linux/>linux</a></li><li><a href=https://simonevellei.com/blog/tags/iot/>iot</a></li><li><a href=https://simonevellei.com/blog/tags/embedded/>embedded</a></li><li><a href=https://simonevellei.com/blog/tags/experiment/>experiment</a></li></ul><nav class=paginav><a class=prev href=https://simonevellei.com/blog/posts/netbsd-on-a-rock64-board/><span class=title>« Prev Page</span><br><span>NetBSD on a ROCK64 Board</span></a>
<a class=next href=https://simonevellei.com/blog/posts/anthropic-claude-integration-with-go-and-lingoose/><span class=title>Next Page »</span><br><span>Anthropic's Claude Integration with Go and Lingoose</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share FreeBSD on a ROCK64 Board on twitter" href="https://twitter.com/intent/tweet/?text=FreeBSD%20on%20a%20ROCK64%20Board&amp;url=https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f&amp;hashtags=freebsd%2clinux%2ciot%2cembedded%2cexperiment"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share FreeBSD on a ROCK64 Board on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f&amp;title=FreeBSD%20on%20a%20ROCK64%20Board&amp;summary=FreeBSD%20on%20a%20ROCK64%20Board&amp;source=https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share FreeBSD on a ROCK64 Board on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f&title=FreeBSD%20on%20a%20ROCK64%20Board"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share FreeBSD on a ROCK64 Board on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share FreeBSD on a ROCK64 Board on whatsapp" href="https://api.whatsapp.com/send?text=FreeBSD%20on%20a%20ROCK64%20Board%20-%20https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share FreeBSD on a ROCK64 Board on telegram" href="https://telegram.me/share/url?text=FreeBSD%20on%20a%20ROCK64%20Board&amp;url=https%3a%2f%2fsimonevellei.com%2fblog%2fposts%2ffreebsd-on-a-rock64-board%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://simonevellei.com/blog>Simone Vellei Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>