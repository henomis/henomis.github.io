<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>FreeBSD on a ROCK64 Board - Simone Vellei - Blog</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://simonevellei.com/en/freebsd-on-a-rock64-board/">
<meta property="og:site_name" content="Simone Vellei - Blog"><meta property="og:title" content="FreeBSD on a ROCK64 Board"><meta property="og:description" content="This is a story about an embedded board and a BSD system. The title could have been “How to resurrect a forgotten board and fall in love with BSD operating systems, again”. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-01T16:37:37+01:00"><meta property="article:modified_time" content="2024-11-01T16:37:37+01:00"><meta property="article:tag" content="Freebsd"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Iot"><meta property="article:tag" content="Embedded"><meta property="article:tag" content="Experiment"><meta property="og:image" content="https://simonevellei.com/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://simonevellei.com/logo.png"><meta name=twitter:title content="FreeBSD on a ROCK64 Board"><meta name=twitter:description content="This is a story about an embedded board and a BSD system. The title could have been “How to resurrect a forgotten board and fall in love with BSD operating systems, again”. It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port."><meta name=application-name content="Simone Vellei"><meta name=apple-mobile-web-app-title content="Simone Vellei"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://simonevellei.com/en/freebsd-on-a-rock64-board/><link rel=prev href=https://simonevellei.com/en/anthropic-claude-integration-with-go-and-lingoose/><link rel=next href=https://simonevellei.com/en/netbsd-on-a-rock64-board/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"FreeBSD on a ROCK64 Board","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/simonevellei.com\/en\/freebsd-on-a-rock64-board\/"},"genre":"posts","keywords":"freebsd, linux, iot, embedded, experiment","wordcount":1585,"url":"https:\/\/simonevellei.com\/en\/freebsd-on-a-rock64-board\/","datePublished":"2024-11-01T16:37:37+01:00","dateModified":"2024-11-01T16:37:37+01:00","license":"© 2025 Simone Vellei. All rights reserved.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Simone Vellei"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/en/ title="Simone Vellei - Blog"><span class=header-title-pre>👋</span>Simone Vellei</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/en/posts/>Posts </a><a class=menu-item href=/en/tags/>Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/freebsd-on-a-rock64-board/>Italiano</option><option value=/en/freebsd-on-a-rock64-board/ selected>English</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/en/ title="Simone Vellei - Blog"><span class=header-title-pre>👋</span>Simone Vellei</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/en/posts/ title>Posts</a><a class=menu-item href=/en/tags/ title>Tags</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/freebsd-on-a-rock64-board/>Italiano</option><option value=/en/freebsd-on-a-rock64-board/ selected>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">FreeBSD on a ROCK64 Board</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/en/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Simone Vellei</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-11-01>2024-11-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1585 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;8 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/rock64-004.png data-srcset="/images/rock64-004.png, /images/rock64-004.png 1.5x, /images/rock64-004.png 2x" data-sizes=auto alt=/images/rock64-004.png title=/images/rock64-004.png></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#the-resurrection>The resurrection</a></li><li><a href=#documentation>Documentation</a></li><li><a href=#the-bsd-way>The BSD way</a></li><li><a href=#never-give-up>Never give up</a></li><li><a href=#attempt-1-building-the-freebsd-kernel-on-a-linux-system>Attempt #1: Building the FreeBSD kernel on a Linux system</a></li><li><a href=#attempt-2-building-the-freebsd-kernel-on-a-freebsd-system>Attempt #2: Building the FreeBSD kernel on a FreeBSD system</a><ul><li><a href=#booting-the-freebsd-virtual-machine>Booting the FreeBSD virtual machine</a></li><li><a href=#building-the-freebsd-kernel>Building the FreeBSD kernel</a></li><li><a href=#copying-the-kernel-to-the-rock64-image>Copying the kernel to the ROCK64 image</a></li><li><a href=#flashing-the-emmc>Flashing the eMMC</a></li></ul></li><li><a href=#the-moment-of-truth>The moment of truth</a></li><li><a href=#conclusion-and-questions>Conclusion and questions</a></li></ul></nav></div></div><div class=content id=content><p>This is a story about an embedded board and a BSD system. The title could have been &ldquo;How to resurrect a forgotten board and fall in love with BSD operating systems, again&rdquo;.
It all started 6 years ago when I bought 4 Pine Rock64 boards, with a well planned project in my mind. Each board was equipped with a Rockchip RK3328 quad-core ARM Cortex A53 64-Bit processor, 4GB of RAM, 32GB of eMMC storage, and a Gigabit Ethernet port.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/rock64-001.png data-srcset="/images/rock64-001.png, /images/rock64-001.png 1.5x, /images/rock64-001.png 2x" data-sizes=auto alt=/images/rock64-001.png title=image></p><p>The project was to build a cluster of 4 boards to experiment with Kubernetes and Docker. I was very excited about the project, but unfortunately, I never had the time to go through it. The only thing I did was to build a rack to hold the 4 boards together, including a small 5-port switch and a power supply. The rack was placed in a corner of my office and forgotten after some preliminary tests.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/rock64-003.png data-srcset="/images/rock64-003.png, /images/rock64-003.png 1.5x, /images/rock64-003.png 2x" data-sizes=auto alt=/images/rock64-003.png title=image></p><h2 id=the-resurrection>The resurrection</h2><p>Some days ago I was cleaning my office and I found the rack with the 4 boards. I decided to give it a try and see if I could make them work. I connected the power supply and the switch, and I powered on the boards. The boards were booting, I tried to connect to them using the serial console, but I couldn&rsquo;t remember the root password. I took that as a <strong>sign</strong>, let&rsquo;s start from scratch, again. I still had the original eMMC USB adapter to flash an OS image and more or less 20 years of IoT experience on my shoulders. Ready, set, go!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/rock64-002.png data-srcset="/images/rock64-002.png, /images/rock64-002.png 1.5x, /images/rock64-002.png 2x" data-sizes=auto alt=/images/rock64-002.png title=image></p><h2 id=documentation>Documentation</h2><p>First thing first, let&rsquo;s check the documentation. I went to the Pine64 website and I found the <a href=https://pine64.org/devices/rock64/ target=_blank rel="noopener noreffer">Rock64 device</a> page and the <a href=https://wiki.pine64.org/wiki/Rock64 target=_blank rel="noopener noreffer">Rock64 wiki</a>. Time flies, and I remember a different website, but I&rsquo;m happy to see the <a href=https://pine64.org/documentation/ROCK64/Software/Releases/ target=_blank rel="noopener noreffer">Release</a> page with the latest supported OS images. There are many Linux distributions, Debian, the derived Armbian, and a plethora of Android versions. Hey, am I getting so old? Then my heart calmed down when I saw the FreeBSD, NetBSD, and OpenBSD support.</p><blockquote><p>&ldquo;They are still there&rdquo;, I thought.</p></blockquote><p>However, just to understand if the boards were still working, I decided to flash the latest Armbian image. I downloaded the image, flashed it on the eMMC, and powered on a board. The board booted, and I managed to connect to it using the serial console.</p><blockquote><p>Cool! But wait&mldr;look at the <code>ps aux</code> output!</p></blockquote><p>Sorry guys, I&rsquo;m old school, I can&rsquo;t stand <code>systemd</code>. Yes, I must confess to have been lazy last years and to have been using Ubuntu for my desktop PC, but come on, it&rsquo;s an embedded board, I would have liked to squeeze the maximum performance out of it and full control of the system. My heart turned suddenly less happy.</p><h2 id=the-bsd-way>The BSD way</h2><p>I&rsquo;ll make it short, but it could deserve an additional post. My first experience with a BSD OS was with OpenBSD at the University in 2003 to pass the Security and Cryptography exam. I had to research and write a paper about the security and cryptography features of OpenBSD. I started installing OpenBSD on my desktop PC to put my hands on it, and I fell in love with it. But, again, that&rsquo;s another story.</p><p>I decided to install FreeBSD on the Rock64 boards. I went to the FreeBSD website and discovered that there were pre-built ROCK64 arm images.</p><blockquote><p>&ldquo;Wow, that&rsquo;s amazing!&rdquo;, I thought.</p></blockquote><p>I downloaded the image, flashed it on the eMMC, and powered on a board. All seemed to work fine, but at some point the board froze. I tried to understand what was happening, but I couldn&rsquo;t find the root cause. From this point on, I started to investigate the issue, and I found that the issue was related to eMMC boot support.</p><blockquote><p>Ah-ah it would have been too easy!</p></blockquote><h2 id=never-give-up>Never give up</h2><p>The issue was that the FreeBSD kernel included into the ROCK64 image didn&rsquo;t support the eMMC boot. However, after some research, I found a <a href=https://www.idatum.net/ads-b-on-a-rock64-with-freebsd-stable14.html target=_blank rel="noopener noreffer">blog post</a> that explained how to build a custom kernel and fix the issue for that board.</p><blockquote><p>Nice! But&mldr;did I tell you that I became a lazy Linux Ubuntu user?</p></blockquote><p>The post&rsquo;s author explains how to build the kernel on a FreeBSD system, and my next question was: &ldquo;Is it possible to build a FreeBSD kernel on a Linux system?&rdquo;. Back to Google search and this time I landed on a FreeBSD <a href=https://wiki.freebsd.org/BuildingOnNonFreeBSD target=_blank rel="noopener noreffer">wiki page</a> that explains how to build a FreeBSD kernel on a Linux system. I&rsquo;m used to build Linux embedded systems from scratch starting from cross-compiling the kernel, so I felt at home.</p><h2 id=attempt-1-building-the-freebsd-kernel-on-a-linux-system>Attempt #1: Building the FreeBSD kernel on a Linux system</h2><p>I followed the instructions and downloaded the FreeBSD source code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git clone https://git.FreeBSD.org/src.git
</span></span></code></pre></td></tr></table></div></div><p>I then installed the required packages on my Ubuntu system</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt install clang libarchive-dev libbz2-dev
</span></span></code></pre></td></tr></table></div></div><p>Since Linux doesn&rsquo;t include a version of bmake by default, building should be done using the script <code>tools/build/make.py</code> which will bootstrap bmake before attempting to build.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>export</span> <span class=nv>MAKEOBJDIRPREFIX</span><span class=o>=</span>~/freebsd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tools/build/make.py buildkernel <span class=nv>TARGET</span><span class=o>=</span>arm64 <span class=nv>TARGET_ARCH</span><span class=o>=</span>aarch64 <span class=nv>KERNCONF</span><span class=o>=</span>ROCK64
</span></span></code></pre></td></tr></table></div></div><p>However, the build failed with an error related to the missing <code>config</code> command. I&rsquo;m still not sure I haven&rsquo;t missed something, but I decided to try another approach.</p><h2 id=attempt-2-building-the-freebsd-kernel-on-a-freebsd-system>Attempt #2: Building the FreeBSD kernel on a FreeBSD system</h2><p>I realized I needed a FreeBSD system to compile the kernel.</p><blockquote><p><em>What&rsquo;s the fastest way to have a FreeBSD system up and running? A virtual machine somewhere in the cloud, or&mldr;a virtual machine on my PC! Where are you, QEMU, my old friend?</em></p></blockquote><p>The next surprise would have been finding precompiled FreeBSD qcow2 images in the <a href=https://download.freebsd.org/releases/VM-IMAGES/14.1-RELEASE/amd64/Latest/ target=_blank rel="noopener noreffer">official repository</a>. It seemed that I was lucky, and I downloaded the image and started a virtual machine with QEMU. However to have enough space to build the kernel I had to resize the disk image. From this point on, this story will become more nerdy.</p><h3 id=booting-the-freebsd-virtual-machine>Booting the FreeBSD virtual machine</h3><p>Let&rsquo;s resize the disk image and boot the virtual machine.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ qemu-img resize ~/FreeBSD-14.1-RELEASE-amd64-zfs.qcow2 +10G
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ qemu-system-x86_64 -hda ~/FreeBSD-14.1-RELEASE-amd64-zfs.qcow2 -m <span class=m>2048</span> -enable-kvm  -netdev user,id<span class=o>=</span>mynet0,hostfwd<span class=o>=</span>tcp:127.0.0.1:7722-:22 -device e1000,netdev<span class=o>=</span>mynet0
</span></span></code></pre></td></tr></table></div></div><p>I connected to the virtual machine and then expanded the last partition on the virtual disk to make use of this new space.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gpart show ada0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gpart resize -i <span class=m>4</span> -a 4k ada0
</span></span></code></pre></td></tr></table></div></div><p>Once the partition has been resized, I instructed ZFS to expand the pool to use the additional space.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ zpool list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ zpool online -e zroot ada0p4
</span></span></code></pre></td></tr></table></div></div><h3 id=building-the-freebsd-kernel>Building the FreeBSD kernel</h3><p>After cloning the FreeBSD source code, I installed the required packages.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pkg update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ pkg install git gcc gmake python pkgconf pixman bison glib 
</span></span></code></pre></td></tr></table></div></div><p>and finally I built the kernel.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>make buildkernel <span class=nv>TARGET</span><span class=o>=</span>arm64 <span class=nv>KERNCONF</span><span class=o>=</span>ROCK64
</span></span></code></pre></td></tr></table></div></div><p>Cool! It worked! I was very close to the final goal. I only needed to copy the kernel to the ROCK64 image and then flash it on the eMMC.</p><h3 id=copying-the-kernel-to-the-rock64-image>Copying the kernel to the ROCK64 image</h3><p>I downloaded the ROCK64 image from the <a href=https://download.freebsd.org/ftp/snapshots/ISO-IMAGES/14.1/ target=_blank rel="noopener noreffer">FreeBSD website</a> and uncompressed it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ wget https://download.freebsd.org/ftp/snapshots/ISO-IMAGES/14.1/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img.xz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ unxz FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img.xz
</span></span></code></pre></td></tr></table></div></div><p>Then I mounted the boot partition of the image</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mdconfig -a -t vnode -f /root/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mdconfig -l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gpart show md0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mount -t ufs /dev/md0p2 /mnt
</span></span></code></pre></td></tr></table></div></div><p>Ok, back to the kernel build directory, I copied the kernel to the boot partition of the ROCK64 image and unmounted it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ make installkernel <span class=nv>TARGET</span><span class=o>=</span>arm64 <span class=nv>KERNCONF</span><span class=o>=</span>ROCK64 <span class=nv>DESTDIR</span><span class=o>=</span>/mnt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ umount /mnt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mdconfig -d -u md0
</span></span></code></pre></td></tr></table></div></div><h3 id=flashing-the-emmc>Flashing the eMMC</h3><p>I connected the eMMC USB adapter to my PC and I flashed the ROCK64 image on the eMMC.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ scp -P <span class=m>7722</span> root@localhost:/root/FreeBSD-14.1-STABLE-arm64-aarch64-ROCK64-20241017-d36ba3989ca9-269125.img ~/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo dd <span class=k>if</span><span class=o>=</span>FreeBSD-13.4-STABLE-arm64-aarch64-ROCK64-20241024-9db8fd4c2adc-258557.img <span class=nv>of</span><span class=o>=</span>/dev/sda <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>status</span><span class=o>=</span>progress
</span></span></code></pre></td></tr></table></div></div><h2 id=the-moment-of-truth>The moment of truth</h2><p>I powered on the board, and it booted successfully. I connected to the board using the serial console and could see the FreeBSD boot messages. I was very happy, and I felt like a child with a new toy. I started to explore the system, and I found that the board was working fine. I could connect to the board using SSH, and I could install packages using the package manager.</p><blockquote><p>&ldquo;I did it!&rdquo;, I thought.</p></blockquote><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/rock64-005.png data-srcset="/images/rock64-005.png, /images/rock64-005.png 1.5x, /images/rock64-005.png 2x" data-sizes=auto alt=/images/rock64-005.png title=image></p><h2 id=conclusion-and-questions>Conclusion and questions</h2><p>I&rsquo;m very happy to have resurrected the Rock64 boards and to have installed FreeBSD on them. However, I have some questions that I would like to share with you.</p><ol><li><p>Nice story, but was it worth it? I mean, was it worth spending so much time to install FreeBSD on a Rock64 board when I could have used QEMU to run a FreeBSD virtual machine on my PC? <strong>Yes, it was worth it. I learned a lot of things, and I had fun. The feeling of having a physical board running FreeBSD is priceless.</strong></p></li><li><p>Nice try, could there be other, simpler ways to achieve the same result? <strong>I&rsquo;m pretty sure there are different ways to achieve the same result as well as I&rsquo;m also sure that I might have missed something in the process. But, again, I had fun.</strong></p></li><li><p>What was the first shell command I typed into the FreeBSD system? <strong>Did I tell you I can&rsquo;t stand <code>systemd</code>? I wanted to be sure to have the init system I like, so I typed <code>ls /etc/rc.d/</code>.</strong></p></li><li><p>Why did I choose FreeBSD instead of OpenBSD or NetBSD? <strong>Oh, well&mldr;this story could have a sequel 😉.</strong></p></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2024-11-01</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/en/freebsd-on-a-rock64-board/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://simonevellei.com/en/freebsd-on-a-rock64-board/ data-hashtag=freebsd><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://simonevellei.com/en/freebsd-on-a-rock64-board/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://simonevellei.com/en/freebsd-on-a-rock64-board/ data-title="FreeBSD on a ROCK64 Board" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/en/tags/freebsd/>Freebsd</a>,&nbsp;<a href=/en/tags/linux/>Linux</a>,&nbsp;<a href=/en/tags/iot/>Iot</a>,&nbsp;<a href=/en/tags/embedded/>Embedded</a>,&nbsp;<a href=/en/tags/experiment/>Experiment</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/en/>Home</a></span></section></div><div class=post-nav><a href=/en/anthropic-claude-integration-with-go-and-lingoose/ class=prev rel=prev title="Anthropic's Claude Integration with Go and Lingoose"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Anthropic's Claude Integration with Go and Lingoose</a>
<a href=/en/netbsd-on-a-rock64-board/ class=next rel=next title="NetBSD on a ROCK64 Board">NetBSD on a ROCK64 Board<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/en/ target=_blank>Simone Vellei</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.it.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},cookieconsent:{content:{allow:"Allow cookies",close:"&#x274c;",deny:"Decline",dismiss:"Got it!",href:"https://www.cookiesandyou.com",link:"Learn more",message:"This website uses cookies to improve your experience.",policy:"Cookie Policy",target:"_blank"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless",type:"opt-out"},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/en/index.json",lunrLanguageCode:"en",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>